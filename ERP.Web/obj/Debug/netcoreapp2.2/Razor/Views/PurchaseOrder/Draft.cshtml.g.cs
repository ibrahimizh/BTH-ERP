#pragma checksum "D:\Projects\BTH-ERP-Latest\ERP.Web\Views\PurchaseOrder\Draft.cshtml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "563654069a77361d9c7cb301f3a156ddf36a8498"
// <auto-generated/>
#pragma warning disable 1591
[assembly: global::Microsoft.AspNetCore.Razor.Hosting.RazorCompiledItemAttribute(typeof(AspNetCore.Views_PurchaseOrder_Draft), @"mvc.1.0.view", @"/Views/PurchaseOrder/Draft.cshtml")]
[assembly:global::Microsoft.AspNetCore.Mvc.Razor.Compilation.RazorViewAttribute(@"/Views/PurchaseOrder/Draft.cshtml", typeof(AspNetCore.Views_PurchaseOrder_Draft))]
namespace AspNetCore
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.AspNetCore.Mvc.Rendering;
    using Microsoft.AspNetCore.Mvc.ViewFeatures;
#line 1 "D:\Projects\BTH-ERP-Latest\ERP.Web\Views\_ViewImports.cshtml"
using ERP.Web;

#line default
#line hidden
#line 2 "D:\Projects\BTH-ERP-Latest\ERP.Web\Views\_ViewImports.cshtml"
using ERP.Web.Models;

#line default
#line hidden
#line 3 "D:\Projects\BTH-ERP-Latest\ERP.Web\Views\_ViewImports.cshtml"
using ERP.Models;

#line default
#line hidden
#line 4 "D:\Projects\BTH-ERP-Latest\ERP.Web\Views\_ViewImports.cshtml"
using ERP.Models.Enums;

#line default
#line hidden
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"563654069a77361d9c7cb301f3a156ddf36a8498", @"/Views/PurchaseOrder/Draft.cshtml")]
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"be0fb84b3fa7568212f38bae63456c535fc95cf6", @"/Views/_ViewImports.cshtml")]
    public class Views_PurchaseOrder_Draft : global::Microsoft.AspNetCore.Mvc.Razor.RazorPage<DraftPurchaseOrderVM>
    {
        #pragma warning disable 1998
        public async override global::System.Threading.Tasks.Task ExecuteAsync()
        {
            BeginContext(29, 250, true);
            WriteLiteral("<div class=\"card card-default\">\r\n    <div class=\"card-header\">\r\n        <div class=\"row\">\r\n            <div class=\"col-md-3\">\r\n                <h3>Purchase Order Details</h3>\r\n            </div>\r\n            <div class=\"col-md-2\">\r\n                <a");
            EndContext();
            BeginWriteAttribute("class", " class=\"", 279, "\"", 326, 3);
            WriteAttributeValue("", 287, "btn", 287, 3, true);
            WriteAttributeValue(" ", 290, "btn-success", 291, 12, true);
#line 9 "D:\Projects\BTH-ERP-Latest\ERP.Web\Views\PurchaseOrder\Draft.cshtml"
WriteAttributeValue(" ", 302, ViewBag.ConfirmPOClass, 303, 23, false);

#line default
#line hidden
            EndWriteAttribute();
            BeginContext(327, 480, true);
            WriteLiteral(@" id=""btnConfirmPO"" href=""#"">Confirm</a>
                
            </div>
        </div>
        
        
        
    </div>
    <div class=""card-body"">
        <table class=""table table-bordered"">
            <thead>
                <tr>
                    <th>Id</th>
                    <th>Supplier</th>
                    <th>Created On</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>");
            EndContext();
            BeginContext(808, 19, false);
#line 28 "D:\Projects\BTH-ERP-Latest\ERP.Web\Views\PurchaseOrder\Draft.cshtml"
                   Write(Model.DraftOrder.Id);

#line default
#line hidden
            EndContext();
            BeginContext(827, 31, true);
            WriteLiteral("</td>\r\n                    <td>");
            EndContext();
            BeginContext(859, 29, false);
#line 29 "D:\Projects\BTH-ERP-Latest\ERP.Web\Views\PurchaseOrder\Draft.cshtml"
                   Write(Model.DraftOrder.SupplierName);

#line default
#line hidden
            EndContext();
            BeginContext(888, 31, true);
            WriteLiteral("</td>\r\n                    <td>");
            EndContext();
            BeginContext(920, 28, false);
#line 30 "D:\Projects\BTH-ERP-Latest\ERP.Web\Views\PurchaseOrder\Draft.cshtml"
                   Write(Model.DraftOrder.CreatedDate);

#line default
#line hidden
            EndContext();
            BeginContext(948, 415, true);
            WriteLiteral(@"</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
<br />
<div class=""card card-default"">

    <div class=""card-header"">
        <div class=""row"">
            <div class=""col-md-2"">
                <h3>Items</h3>
            </div>
        </div>
        <div class=""row"">
            <div class=""col-md-2"">Select Material</div>
            <div class=""col-md-4"">
");
            EndContext();
            BeginContext(1470, 968, true);
            WriteLiteral(@"                <div class=""form-group"">
                    <input id=""autocomplete"" class=""form-control"">
                    <input id=""selectedMaterial"" type=""hidden"" />
                    <input id=""selectedMaterialName"" type=""hidden"" />
                </div>
            </div>
            <div class=""col-md-2"">Quantity</div>
            <div class=""col-md-2"">
                <input class=""form-control"" type=""number"" id=""txtQuantity"" required min=""0.1"" />
            </div>
            <div class=""col-md-2"">
                <button class=""btn btn-primary"" id=""btnAddItem"">Add</button>
            </div>
        </div>
    </div>
    <div class=""card-body"">

        <table class=""table table-bordered tablePOItems"">
            <thead>
                <tr>
                    <th>Material</th>
                    <th>Quantity</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>

");
            EndContext();
#line 76 "D:\Projects\BTH-ERP-Latest\ERP.Web\Views\PurchaseOrder\Draft.cshtml"
                 foreach (var item in Model.DraftOrder.Items)
                {

#line default
#line hidden
            BeginContext(2520, 54, true);
            WriteLiteral("                    <tr>\r\n                        <td>");
            EndContext();
            BeginContext(2575, 17, false);
#line 79 "D:\Projects\BTH-ERP-Latest\ERP.Web\Views\PurchaseOrder\Draft.cshtml"
                       Write(item.MaterialName);

#line default
#line hidden
            EndContext();
            BeginContext(2592, 35, true);
            WriteLiteral("</td>\r\n                        <td>");
            EndContext();
            BeginContext(2628, 20, false);
#line 80 "D:\Projects\BTH-ERP-Latest\ERP.Web\Views\PurchaseOrder\Draft.cshtml"
                       Write(item.OrderedQuantity);

#line default
#line hidden
            EndContext();
            BeginContext(2648, 88, true);
            WriteLiteral("</td>\r\n                        <td><button class=\"btn btn-danger deletePOItem\" data-id=\'");
            EndContext();
            BeginContext(2737, 7, false);
#line 81 "D:\Projects\BTH-ERP-Latest\ERP.Web\Views\PurchaseOrder\Draft.cshtml"
                                                                            Write(item.Id);

#line default
#line hidden
            EndContext();
            BeginContext(2744, 51, true);
            WriteLiteral("\'>Delete</button></td>\r\n                    </tr>\r\n");
            EndContext();
#line 83 "D:\Projects\BTH-ERP-Latest\ERP.Web\Views\PurchaseOrder\Draft.cshtml"
                }

#line default
#line hidden
            BeginContext(2814, 567, true);
            WriteLiteral(@"            </tbody>
        </table>

    </div>
    <div class=""row""><p>&nbsp;</p></div>
    <div class=""row"">
        <div class=""col-md-6"">
            <table class=""table table-bordered"">
                <thead>
                    <tr class=""bg-light"">
                        <th>Event Type</th>
                        <th>Date/Time</th>
                        <th>Added By</th>
                    </tr>
                </thead>
                <tbody class=""tbodyEvents""></tbody>
            </table>
        </div>
    </div>
</div>

");
            EndContext();
            DefineSection("Scripts", async() => {
                BeginContext(3398, 672, true);
                WriteLiteral(@"
    <script>
        $(document).ready(function () {
            getEvents();
            var materialsData = [];
            bindMaterialsDropdown();
            $(""#autocomplete"").autocomplete({                
                source: materialsData,
                select: function (event, ui) {
                    $(""#selectedMaterial"").val(ui.item.id);
                    $(""#selectedMaterialName"").val(ui.item.label);
                    console.log(ui.item.id);
                }
                
            });
            function bindMaterialsDropdown() {
                $.ajax({
                    type: 'GET',
                    url: '");
                EndContext();
                BeginContext(4071, 46, false);
#line 123 "D:\Projects\BTH-ERP-Latest\ERP.Web\Views\PurchaseOrder\Draft.cshtml"
                     Write(Url.Action("GetMaterialsDropdown","Materials"));

#line default
#line hidden
                EndContext();
                BeginContext(4117, 599, true);
                WriteLiteral(@"'
                })
                    .done(function (data) {
                        $.each(data, function (index, value) {
                            //$(""#ddlMaterials"").append(""<option value='"" + value.value + ""'>"" + value.text + ""</option>"");
                            materialsData.push({""label"":value.text,""id"":value.value});
                        });
                        
                    });
            }

            $(""#btnConfirmPO"").click(function () {
                
                $.ajax({
                    type: 'POST',
                    url: '");
                EndContext();
                BeginContext(4717, 21, false);
#line 138 "D:\Projects\BTH-ERP-Latest\ERP.Web\Views\PurchaseOrder\Draft.cshtml"
                     Write(Url.Action("Confirm"));

#line default
#line hidden
                EndContext();
                BeginContext(4738, 52, true);
                WriteLiteral("\',\r\n                    data: JSON.stringify({Value:");
                EndContext();
                BeginContext(4791, 19, false);
#line 139 "D:\Projects\BTH-ERP-Latest\ERP.Web\Views\PurchaseOrder\Draft.cshtml"
                                           Write(Model.DraftOrder.Id);

#line default
#line hidden
                EndContext();
                BeginContext(4810, 218, true);
                WriteLiteral("}),\r\n                    dataType: \'json\',\r\n                    contentType: \"application/json; charset=utf-8\",\r\n                })\r\n                .done(function (data) {\r\n                    window.location.href = \'");
                EndContext();
                BeginContext(5029, 52, false);
#line 144 "D:\Projects\BTH-ERP-Latest\ERP.Web\Views\PurchaseOrder\Draft.cshtml"
                                       Write(Url.Action("Confirmed",new{id=@Model.DraftOrder.Id}));

#line default
#line hidden
                EndContext();
                BeginContext(5081, 606, true);
                WriteLiteral(@"';
                });
            });

        $(""#btnAddItem"").click(function(){
            var materialId = $('#selectedMaterial').val();
            var materialName = $(""#selectedMaterialName"").val();
            if(materialId)
            {
                var quantity=$('#txtQuantity').val();

                if(quantity){
                    if(parseFloat(quantity)<0.1)
                    {
                        alert(""Invalid Quantity!"");
                    }
                    else{
                        var newItem={
                            ""PurchaseOrderId"":");
                EndContext();
                BeginContext(5688, 19, false);
#line 162 "D:\Projects\BTH-ERP-Latest\ERP.Web\Views\PurchaseOrder\Draft.cshtml"
                                         Write(Model.DraftOrder.Id);

#line default
#line hidden
                EndContext();
                BeginContext(5707, 278, true);
                WriteLiteral(@",
                            ""MaterialId"":materialId,
                            ""OrderedQuantity"":quantity
                        };
                        
                        $.ajax({
                            type: 'POST',
                            url: '");
                EndContext();
                BeginContext(5986, 21, false);
#line 169 "D:\Projects\BTH-ERP-Latest\ERP.Web\Views\PurchaseOrder\Draft.cshtml"
                             Write(Url.Action("AddItem"));

#line default
#line hidden
                EndContext();
                BeginContext(6007, 2015, true);
                WriteLiteral(@"', 
                            data: JSON.stringify(newItem),
                            dataType: 'json',
                            contentType: ""application/json; charset=utf-8"",
                        })
                        .done(function(data){                
                            // show the response
                            if(data>0)
                            {
                                

                                var addedItemText=materialName;
                                var orderedItemQuantity=$('#txtQuantity').val();
                                var markup = ""<tr><td>""+addedItemText+""</td><td>""+orderedItemQuantity+""</td><td><button class='btn btn-danger deletePOItem' data-id='""+data+""'>Delete</button></td></tr>"";
                                $("".tablePOItems tbody"").append(markup);
                                $('#selectedMaterial').val('');
                                $(""#selectedMaterialName"").val('');
                            ");
                WriteLiteral(@"    $(""#autocomplete"").val('');
                                $('#txtQuantity').val(0);

                                $(""#btnConfirmPO"").show();

                            }
                            
                        })
                        .fail(function() {            
                            // just in case posting your form failed
                            alert( ""Error: Failed to add item!"" );
                            
                        });
                    }
                }
                else{
                    alert(""Enter Quantity!"");
                }
            }
            else{
                alert(""Select Item to add"");
            }
        });


        $("".tablePOItems"").on('click', '.deletePOItem', function(){
            var deleteButton=$(this);
            var itemId=deleteButton.attr(""data-id"");
            
            $.ajax({
                type: 'GET',
                url: '");
                EndContext();
                BeginContext(8023, 40, false);
#line 217 "D:\Projects\BTH-ERP-Latest\ERP.Web\Views\PurchaseOrder\Draft.cshtml"
                 Write(Url.Action("RemoveItem","PurchaseOrder"));

#line default
#line hidden
                EndContext();
                BeginContext(8063, 738, true);
                WriteLiteral(@"'+'/'+itemId
            })
            .done(function(data){                
                // show the response
                if(data)
                {
                    deleteButton.closest('tr').remove();
                    var rowCount = $('.tablePOItems tbody tr').length;
                    if(rowCount===0){
                       $(""#btnConfirmPO"").hide();
                    }
                }                
            })
            .fail(function() {            
                // just in case posting your form failed
                alert( ""Error: Failed to delete item!"" );
                
            });
        });

        function getEvents() {
            
            let url = '");
                EndContext();
                BeginContext(8802, 39, false);
#line 239 "D:\Projects\BTH-ERP-Latest\ERP.Web\Views\PurchaseOrder\Draft.cshtml"
                  Write(Url.Action("GetEvents","PurchaseOrder"));

#line default
#line hidden
                EndContext();
                BeginContext(8841, 9, true);
                WriteLiteral("\' + \'/\' +");
                EndContext();
                BeginContext(8851, 19, false);
#line 239 "D:\Projects\BTH-ERP-Latest\ERP.Web\Views\PurchaseOrder\Draft.cshtml"
                                                                   Write(Model.DraftOrder.Id);

#line default
#line hidden
                EndContext();
                BeginContext(8870, 738, true);
                WriteLiteral(@";
            console.log('Attempting to get events! '+url);
            $.ajax({
                    type: 'GET',
                    url: url
                })
                .done(function (data) {
                    // show the response
                    console.log('events data'+JSON.stringify(data));
                    $.each(data, function (index, value) {
                            console.log('Events: ' + JSON.stringify(value));
                            $('.tbodyEvents').append(""<tr><td>"" + value.eventType + ""</td><td>"" + value.timestamp +  ""</td><td>"" + value.addedBy + ""</td></tr>"");
                            
                        });
                });
        }
    });
    </script>
");
                EndContext();
            }
            );
        }
        #pragma warning restore 1998
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.ViewFeatures.IModelExpressionProvider ModelExpressionProvider { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IUrlHelper Url { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IViewComponentHelper Component { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IJsonHelper Json { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IHtmlHelper<DraftPurchaseOrderVM> Html { get; private set; }
    }
}
#pragma warning restore 1591
